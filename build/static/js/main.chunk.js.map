{"version":3,"sources":["jiraApiUtls.js","index.js"],"names":["makeJiraApiRequest","a","method","requestPath","body","fetch","headers","JSON","stringify","response","json","makeJqlRequest","jql","fields","resultPropertyPath","maxResults","startAt","allResultsReturned","totalNumberOfResults","total","concat","_","get","console","log","length","getIssuesForKeys","keys","join","issueData","getIssuesLinkedToEpics","epicKeys","IssueType","EPIC","STORY","SPIKE","BUG","Object","freeze","ISSUE_TYPE_FIELD_ID","STATUS_FIELD_ID","STORY_POINTS_FIELD_ID","PAIR_ASSIGNEE_FIELD_ID","EPIC_LINK_FIELD_ID","getDescendantIssueCards","issueCardsAncestorEl","querySelectorAll","getIssueType","issue","issuetype","name","getIssueKey","key","removeExtraField","issueCard","fieldName","fieldSpan","querySelector","fieldDiv","parentNode","removeChild","getIssuesOfType","issues","issueType","filter","getEpicLinkedIssuesMap","epicLinkedIssuesMap","Map","map","linkedEpicKey","getLinkedEpicKey","linkedIssues","set","getIssueKeys","getIssueDataMap","issueCardsMap","issueDataMap","issueKey","handleMutation","descendantIssueCards","issueCardsThatNeedModificationMap","getMapOfIssueCardsThatNeedModification","size","issuesLinkedToEpics","forEach","applyBaseCardModifications","modifyEpicCard","includes","modifyStoryOrSpikeCard","modifyBugCard","linkedIssuesSummary","getIssuesSummary","addEstimatesSummaryField","addStoriesOrSpikesCompletedSummaryField","addStoryPointsSummaryField","addBugsSummaryField","totalNumberOfStoriesOrSpikes","numberOfStoriesOrSpikesWithEstimates","colorizeCard","numberOfBugsClosed","totalNumberOfBugs","content","addExtraField","storyPointsCompleted","totalStoryPoints","numberOfStoriesOrSpikesCompleted","isClosed","status","getStatus","defaultIssuesSummary","reduce","issuesSummary","storyPoints","getStoryPoints","isStoryOrSpike","isBug","pairAssignee","displayName","avatarUrl","avatarEl","text","insertAdjacentHTML","addPairAssigneeAvatar","pairAssigneeField","avatarUrls","getPairAssignee","addDaysInColumnExtraField","getDaysInColumn","addLabeledStoryPointsField","color","setAttribute","fieldId","tooltip","extraFieldsDiv","daysInColumn","issueCards","getAttribute","isIssueCardModifiedByExtension","setIssueCardModifiedByExtension","getIssueCardKey","replace","pairAssigneeStyleApplied","observer","MutationObserver","mutations","mutation","id","target","classAttr","applyPairAssigneeStyle","document","observe","childList","subtree","sheet","createElement","innerHTML","pairAssigneeAvatarStyle","appendChild"],"mappings":"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","file":"static/js/main.chunk.js","sourcesContent":["import _ from 'lodash';\n\n/**\n * Issue a generic Jira API request\n * @param {*} param0 \n * @returns \n */\nexport const makeJiraApiRequest = async (\n  {\n    method='POST',\n    requestPath= \"\",\n    body\n  }\n) => {\n  const BASE_JIRA_API_PATH = '/rest/api/2';\n\n  const response = await fetch(\n    `${BASE_JIRA_API_PATH}/${requestPath}`,\n    {\n      method: method,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(body)\n    }\n  );\n\n  return await response?.json();\n}\n\n/**\n * JQL Request \n * Returns full depaginated results\n * \n * @param {*} param0 \n * @returns \n */\nexport const makeJqlRequest = async (\n  {\n    jql,\n    fields = [],\n    resultPropertyPath = \"issues\",\n    maxResults = 50\n  }\n) => {\n  var startAt = 0;\n  var allResultsReturned = []\n  var totalNumberOfResults = 0;\n\n  do {\n    const response = await makeJiraApiRequest(\n      {\n        requestPath: \"search\",\n        body: {\n          jql,\n          fields,\n          startAt,\n          maxResults\n        }\n      }\n    );\n    \n    totalNumberOfResults = response?.total;\n    allResultsReturned = \n      allResultsReturned.concat(\n        _.get(response, resultPropertyPath, [])\n      );\n    console.log(`je: Got ${allResultsReturned.length} of ${totalNumberOfResults} results for jql ${jql}`);\n    startAt = allResultsReturned?.length;\n  }while(totalNumberOfResults>allResultsReturned.length);\n\n  return allResultsReturned;\n}\n\nexport const getIssuesLinkedToEpic = async (\n  {\n    epicKey,\n    fields = [\"key\",\"issuetype\", \"status\"]\n  }\n) => {\n  return await makeJqlRequest(\n    {\n      jql: `'Epic Link'=${epicKey}`,\n      fields\n    }\n  );\n}\n\nexport const getIssuesForKeys = async (keys, fields=[]) => {\n\n  if(!keys.length) {\n    return [];\n  }\n  const jql = `key in (${keys.join()})`;\n  //const jql = `key in (DOPE-516)`;\n  console.log(`je: getIssuesForKeys: number of keys: ${keys?.length}}`);\n  console.log(`je: getIssuesForKeys: jql: ${jql}}`);\n\n  const issueData = await makeJqlRequest(\n    {\n      jql,\n      fields,\n      maxResults:5000\n    }\n  );\n\n  //console.log(`je: getIssuesForKeys: ${JSON.stringify(issueData, null, 2)}`);\n  console.log(`je: getIssuesForKeys: issueData.length: ${issueData.length}`);\n\n  return issueData;\n}\n\nexport const getIssuesLinkedToEpics = async (epicKeys, fields=[]) => {\n\n  if(!epicKeys.length) {\n    return [];\n  }\n  const jql = `'Epic Link' in (${epicKeys.join()})`;\n  console.log(`je: getIssuesLinkedToEpics: jql: ${jql}}`);\n\n  const issueData = await makeJqlRequest(\n    {\n      jql,\n      fields,\n      maxResults:5000\n    }\n  );\n\n  //console.log(`je: getIssuesLinkedToEpics: ${JSON.stringify(issueData, null, 2)}`);\n  console.log(`je: getIssuesLinkedToEpics: issueData.length: ${issueData.length}`);\n\n  return issueData;\n}\n\n\n\nexport const getIssueForKey = async (\n  {\n    issueKey, \n    fields = []\n  }\n) => {\n  console.log(`Got issue for key ${issueKey} pre`);\n  const result = await makeJqlRequest(\n    {\n      requestPath: \"search\",\n      body: {\n        jql:`'key'=${issueKey}`,\n        fields\n      }\n    }\n  );\n\n  return result;\n}","\nimport {getIssuesForKeys, getIssuesLinkedToEpics} from './jiraApiUtls'\n\nconst IssueType = {\n  EPIC: 'Epic',\n  STORY: 'Story',\n  SPIKE: 'Spike',\n  BUG: 'Bug'\n};\nObject.freeze(IssueType);\n\n// Jira Field Ids\nconst KEY_FIELD_ID = \"key\";\nconst ISSUE_TYPE_FIELD_ID = \"issuetype\";\nconst STATUS_FIELD_ID = \"status\";\n\n\n// Jira Custom Field Ids\nconst STORY_POINTS_FIELD_ID = 'customfield_11901';\nconst PAIR_ASSIGNEE_FIELD_ID = 'customfield_14102';\nconst EPIC_LINK_FIELD_ID = 'customfield_10008';\n\n/**\n * Returns all issue cards that are descendents of the the specified ancestor el\n * \n * @param {*} issueCardsAncestorEl \n * @returns \n */\n const getDescendantIssueCards = issueCardsAncestorEl => {\n  return issueCardsAncestorEl.querySelectorAll(\"div[class*='js-detailview']\");\n}\n\n\nconst isIssueCardModifiedByExtension = (issueCard) => {\n  return issueCard?.getAttribute('modified-by-extension')\n}\n\nconst setIssueCardModifiedByExtension = (issueCard) => {\n  issueCard.setAttribute('modified-by-extension', 'true');\n}\n\nconst getIssueType = issue => {\n  return issue?.fields?.issuetype?.name;\n}\n\nconst getIssueKey = issue => {\n  return issue?.key;\n}\n\nconst removeExtraField = (issueCard, fieldName) => {\n  const fieldSpan = issueCard.querySelector(`span[data-tooltip*='${fieldName}:']`);\n  const fieldDiv = fieldSpan?.parentNode;\n\n  fieldDiv?.parentNode?.removeChild(fieldDiv);\n\n\n}\n\n/**\n * Returns all issues with the specified issue type\n * @param {*} issues \n * @param {*} issueType \n * @returns \n */\nconst getIssuesOfType = (issues, issueType) => {\n\n  return issues.filter(\n    issue => issueType === getIssueType(issue)\n  );\n  \n}\n\nconst getLinkedEpicKey = issue => {\n  return issue?.fields?.[EPIC_LINK_FIELD_ID];\n}\n\n/**\n * Gets a Map of issues with a key of Epic issue key and values of an Array of issues\n * linked to the epic \n * @param {*} issues \n */\nconst getEpicLinkedIssuesMap = issues => {\n  const epicLinkedIssuesMap = new Map();\n  issues.map(\n    issue => {\n      const linkedEpicKey = getLinkedEpicKey(issue);\n\n      if(linkedEpicKey) {\n        const linkedIssues = epicLinkedIssuesMap.get(linkedEpicKey)??[];\n        epicLinkedIssuesMap.set(linkedEpicKey, linkedIssues.concat(issue));\n      }\n    }\n  );\n\n  return epicLinkedIssuesMap;\n}\n\n/**\n * Gets the keys for the collection of issues\n * @param {*} issues \n * @returns \n */\nconst getIssueKeys = issues => {\n  return issues.map(\n    issue => getIssueKey(issue)\n  );\n}\n\nconst getIssueDataMap = (\n  issueCardsMap, \n  issues, \n  epicLinkedIssuesMap\n) => {\n  const issueDataMap = new Map();\n\n  issues.map(\n    issue => {\n      const issueKey =  getIssueKey(issue);\n      issueDataMap.set(\n        issueKey,\n        {\n          issueType: getIssueType(issue),\n          issue,\n          issueCard: issueCardsMap.get(issueKey),\n          linkedIssues: epicLinkedIssuesMap.get(issueKey)\n        }\n      );\n    }\n  );\n\n  return issueDataMap;\n}\n\n/**\n * Updates all issues that are descendents of issueAncestorEl\n * \n * @param {*} issueCardsAncestorEl \n * @returns \n */\nconst handleMutation = async issueCardsAncestorEl => {\n  const descendantIssueCards = getDescendantIssueCards(issueCardsAncestorEl);\n\n  if(!descendantIssueCards?.length) {\n    return;\n  }\n\n  console.log(`je: handleMutation: found ${descendantIssueCards.length} descendant cards`);\n  const issueCardsThatNeedModificationMap = getMapOfIssueCardsThatNeedModification(descendantIssueCards);\n\n  console.log(`je: handleMutation: found ${issueCardsThatNeedModificationMap.size} cards the need modification`);\n  \n  const issues = await getIssuesForKeys(\n    [...issueCardsThatNeedModificationMap.keys()], // Convert map iterator to Array\n    [\n      KEY_FIELD_ID,\n      ISSUE_TYPE_FIELD_ID, \n      STATUS_FIELD_ID,\n      STORY_POINTS_FIELD_ID,\n      PAIR_ASSIGNEE_FIELD_ID,\n      EPIC_LINK_FIELD_ID\n    ]\n  );\n\n  const issuesLinkedToEpics = await getIssuesLinkedToEpics(\n    getIssueKeys(getIssuesOfType(issues, IssueType.EPIC)),\n    [\n      KEY_FIELD_ID,\n      ISSUE_TYPE_FIELD_ID, \n      STATUS_FIELD_ID,\n      STORY_POINTS_FIELD_ID,\n      PAIR_ASSIGNEE_FIELD_ID,\n      EPIC_LINK_FIELD_ID\n    ]\n  );\n\n\n  //console.log(`je: handleMutation: found ${epicIssues.length} epics`);\n  console.log(`je: handleMutation: found ${issuesLinkedToEpics.length} issues linked to epics`);\n\n  console.log(`je: handleMutation: issueData.length: ${issues?.length}`);\n\n  const epicLinkedIssuesMap = getEpicLinkedIssuesMap(issues);\n\n  console.log(`je: handleMutation: found ${epicLinkedIssuesMap.size} epics linked to issues `);\n\n  const issueDataMap = getIssueDataMap(\n    issueCardsThatNeedModificationMap, \n    issues, \n    epicLinkedIssuesMap\n  );\n\n  console.log(`je: handleMutation: issueDataMap size ${issueDataMap.size}`);\n\n  issueDataMap.forEach(\n    (issueData, issueKey) => {\n      const issueType = issueData.issueType;\n\n      // console.log(`Issue data foo: ${JSON.stringify(issueData, null, 2)}`);\n      applyBaseCardModifications(issueData);\n\n      if (IssueType.EPIC === issueType) {        \n        modifyEpicCard(issueData);\n      } else if([IssueType.STORY, IssueType.SPIKE].includes(issueType)) {\n        console.log(`je: handleMutation: is story or spike`);\n        modifyStoryOrSpikeCard(issueData);\n        \n      } else if (IssueType.BUG === issueType) {\n        modifyBugCard(issueData);\n      }\n    }\n\n  );\n\n  \n  console.log(`je: handleMutation: issueData.length: ${issues?.length}`);\n\n}\n\nconst modifyEpicCard = ({issueCard, linkedIssues}) => {\n  \n  const linkedIssuesSummary = getIssuesSummary(linkedIssues);\n\n  addEstimatesSummaryField(\n    issueCard, \n    linkedIssuesSummary\n  );\n\n  addStoriesOrSpikesCompletedSummaryField(\n    issueCard, \n    linkedIssuesSummary\n  );\n\n  addStoryPointsSummaryField(\n    issueCard, \n    linkedIssuesSummary\n  );\n\n  addBugsSummaryField(\n    issueCard, \n    linkedIssuesSummary\n  );\n\n  if(\n    linkedIssuesSummary.totalNumberOfStoriesOrSpikes === 0 ||\n    linkedIssuesSummary.numberOfStoriesOrSpikesWithEstimates != \n      linkedIssuesSummary.totalNumberOfStoriesOrSpikes\n    ) {\n    colorizeCard(issueCard, 'BurlyWood');\n  } else {\n    colorizeCard(issueCard, 'MediumTurquoise');\n  }\n \n}\n\nconst isStoryOrSpike = issue => {\n  return [IssueType.STORY, IssueType.SPIKE].includes(getIssueType(issue));\n}\n\nconst isBug = issue => {\n  return getIssueType(issue) === `Bug`;\n}\n\nconst addBugsSummaryField = (\n  issueCard, \n  {\n    numberOfBugsClosed,\n    totalNumberOfBugs\n  } \n) => {\n  const content = `${numberOfBugsClosed} of ${totalNumberOfBugs} bugs closed`;\n  addExtraField(issueCard, \n    'epicBugsSummary', \n    content,\n    content);\n}\n\n\nconst addEstimatesSummaryField = (\n  issueCard, \n  {\n    numberOfStoriesOrSpikesWithEstimates,\n    totalNumberOfStoriesOrSpikes\n  } \n) => {\n  const content = \n    `${numberOfStoriesOrSpikesWithEstimates} of ${totalNumberOfStoriesOrSpikes} stories estimated`;\n  addExtraField(issueCard, \n    'epicEstimatesSummary', \n    content,\n    content);\n}\n\n\nconst addStoryPointsSummaryField = (issueCard, {storyPointsCompleted, totalStoryPoints}) => {\n  const content = `${storyPointsCompleted} of ${totalStoryPoints} points completed`;\n  addExtraField(issueCard, \n    'epicStoryPointsSummary', \n    content,\n    content);\n}\n\nconst addStoriesOrSpikesCompletedSummaryField = (\n  issueCard, \n  {\n    numberOfStoriesOrSpikesCompleted, \n    totalNumberOfStoriesOrSpikes\n  }\n) => {\n  const content = \n    `${numberOfStoriesOrSpikesCompleted} of ${totalNumberOfStoriesOrSpikes} stories  completed`;\n  addExtraField(issueCard, \n    'epicStoriesCompletedSummary', \n    content,\n    content);\n}\n\nconst getStatus = issue => {\n  return issue?.fields?.status?.name;\n}\n\nconst isClosed = issue => {\n  return getStatus(issue) === 'Closed';\n}\n\nconst getIssuesSummary = issues => {\n\n  const defaultIssuesSummary = {\n     totalNumberOfStoriesOrSpikes: 0,\n     numberOfStoriesOrSpikesWithEstimates:0,\n     numberOfStoriesOrSpikesCompleted:0,\n     totalStoryPoints:0,\n     storyPointsCompleted:0,\n     totalNumberOfBugs:0,\n     numberOfBugsClosed:0\n  };\n \n  return issues?.reduce(\n    (issuesSummary, issue) => {\n      const storyPoints = getStoryPoints(issue);\n\n      if(isStoryOrSpike(issue)) {\n        issuesSummary.totalNumberOfStoriesOrSpikes++;\n\n        if(storyPoints) {\n          issuesSummary.totalStoryPoints += storyPoints;        \n          issuesSummary.numberOfStoriesOrSpikesWithEstimates++;\n        \n          if(isClosed(issue)) {\n            issuesSummary.numberOfStoriesOrSpikesCompleted++;\n            issuesSummary.storyPointsCompleted += storyPoints;\n          }\n        }\n      } else if (isBug(issue)) {\n        issuesSummary.totalNumberOfBugs++;\n        if(isClosed(issue)) {\n          issuesSummary.numberOfBugsClosed++;\n        }\n      }\n\n      return issuesSummary;\n    },\n    defaultIssuesSummary\n  ) ?? defaultIssuesSummary;\n }\n\n\n\nconst getStoryPoints = issue => {\n  return issue?.fields?.[STORY_POINTS_FIELD_ID]??0;\n}\n\n\nconst addPairAssigneeAvatar = (issueCard, pairAssignee) => {\n\n  if(!pairAssignee) {\n    return;\n  }\n\n  const {displayName, avatarUrl} = pairAssignee;\n  const avatarEl = issueCard.querySelector(`div[class='ghx-avatar']`);\n\n  const text = `Pair Assignee: ${displayName}`;\n\n  avatarEl?.parentNode?.insertAdjacentHTML(\n    'beforeend', \n    `<div class=\"pair-assignee-avatar\">\n      <img src=${avatarUrl}\n      class=\"ghx-avatar-img\" alt=\"${text}\" data-tooltip=\"${text}\" original-title=\"\">\n    </div>` \n  );\n}\n\nconst getPairAssignee = issue => {\n  const pairAssigneeField = issue?.fields?.[PAIR_ASSIGNEE_FIELD_ID];\n\n  if(pairAssigneeField) {\n    return {\n      avatarUrl: pairAssigneeField?.avatarUrls['48x48'],\n      displayName: pairAssigneeField?.displayName\n    };\n  } else {\n    return null;\n  }\n}\n\n\nconst applyBaseCardModifications = ({issueCard, issue}) => {\n  \n  addPairAssigneeAvatar(issueCard, getPairAssignee(issue));\n\n  removeExtraField(\n    issueCard,\n    'Story Points' \n  );\n\n  removeExtraField(\n    issueCard,\n    'Pair Assignee' \n  );\n  \n  addDaysInColumnExtraField(\n    getDaysInColumn(issueCard), issueCard\n  );\n}\n\nconst modifyStoryOrSpikeCard = ({issueCard, issue}) => {\n  const storyPoints = getStoryPoints(issue);\n\n  addLabeledStoryPointsField( issueCard, storyPoints);\n\n  if(!storyPoints) {\n    colorizeCard(issueCard, 'Khaki');\n  } else {\n    colorizeCard(issueCard, 'PaleTurquoise');\n  }\n}\n\nconst modifyBugCard = ({issueCard}) => {\n  colorizeCard(issueCard, 'LightPink');\n}\n\n\nconst colorizeCard = (issueCard, color) => {\n  issueCard.setAttribute(\"style\", `background-color:${color};`);\n}\n\nconst addExtraField = (issueCard, fieldId, content, tooltip) => {\n  // If the extra field hasn't already been added\n  if(!issueCard.querySelector(`span[id='${fieldId}']`)) {\n    \n    // Get the extra fields section\n    const extraFieldsDiv = issueCard.querySelector(\"div[class='ghx-extra-fields']\");\n\n    if (extraFieldsDiv) {\n\n      extraFieldsDiv.insertAdjacentHTML(\n        'beforeend', \n        `<div class=\"ghx-extra-field-row\">\n          <span class=\"ghx-extra-field\" id=\"${fieldId}\" data-tooltip=\"${tooltip}\">\n            <span class=\"ghx-extra-field-content\">${content}</span>\n          </span>\n        </div>` \n      );\n    }\n  }\n}\n\nconst addLabeledStoryPointsField = (issueCard, storyPoints) => {\n\n  const content = `Story Points: ${storyPoints}`;\n  addExtraField(\n    issueCard, `labeledStoryPointsField`, content, content\n  );\n}\n\nconst addDaysInColumnExtraField = (daysInColumn, issueCard) => {\n  addExtraField(\n    issueCard, \n    \"daysInColumnField\", \n    `${daysInColumn} days in column`,\n    `${daysInColumn} days in column`\n    );\n}\n\n\nconst getMapOfIssueCardsThatNeedModification = issueCards => {\n  const issueCardsThatNeedModificationMap = new Map();\n\n  console.log(`je: getMapOfIssueCardsThatNeedModification: found ${issueCards.length} descendant cards. type: ${typeof issueCards}`); \n\n  \n  issueCards?.forEach(\n    issueCard => {\n      if( !isIssueCardModifiedByExtension(issueCard)) {\n        setIssueCardModifiedByExtension(issueCard);\n        issueCardsThatNeedModificationMap.set(\n          getIssueCardKey(issueCard),\n          issueCard\n        );\n      }\n    }\n  );\n\n  console.log(`je: getMapOfIssueCardsThatNeedModification: end`); \n  return issueCardsThatNeedModificationMap;\n}\n\nconst getIssueCardKey = issueCard => {\n  return issueCard?.getAttribute(\"data-issue-key\");\n}\n\nconst getDaysInColumn = issue => {\n  const daysInColumn = \n    issue.querySelector(\"div[class='ghx-days']\")?.\n    getAttribute(\"title\")?.\n    replace(\" days in this column\",\"\");\n\n  return daysInColumn??\"Unknown\"\n}\n\n\nvar pairAssigneeStyleApplied = false;\n\n/**\n * Observe mutations and update the board as necessary\n */\n const observer = new MutationObserver(\n  mutations => {  \n    mutations.map(\n      mutation => {\n        const id = mutation.target.getAttribute('id');\n        const classAttr = mutation.target.getAttribute('class');\n       \n        if(\n          id==='ghx-pool' ||\n          classAttr?.includes('ghx-column')\n        ) {\n          if(!pairAssigneeStyleApplied) {\n            \n            applyPairAssigneeStyle();\n            pairAssigneeStyleApplied= true;\n          }\n\n          handleMutation(mutation.target);\n        }\n      }       \n    )\n  }    \n);\n\n\nconst target = document.querySelector(\"html\");\nconst config = { childList:true, subtree:true};\n\n/**\n * Observe all mutations to the DOM\n * TODO: Optimize this later if necessary\n */\n\nobserver.observe(target, config);\n\n\nconst applyPairAssigneeStyle = () => {\n  const sheet = document.createElement('style')\n  sheet.innerHTML = pairAssigneeAvatarStyle;\n  document.body.appendChild(sheet);\n}\n\nconst pairAssigneeAvatarStyle = `\n.ghx-band-1 .ghx-issue .pair-assignee-avatar {\n  right: auto;\n  top: 65px;\n}\n\n.ghx-band-1 .ghx-issue .ghx-type, .ghx-band-1 .ghx-issue .ghx-flags, .ghx-band-1 .ghx-issue .pair-assignee-avatar {\n  left: 8px;\n}\n.ghx-issue.ghx-has-avatar .pair-assignee-avatar {\n  display: block;\n}\n.ghx-issue .pair-assignee-avatar{\n  display: none;\n  position: absolute;\n  right: 10px;\n  top: 50px;\n}\n.ghx-band-2 .ghx-issue .pair-assignee-avatar {\n  right: 5px;\n  top: 30px;\n}\n`;"],"sourceRoot":""}